# Lab 7 - PWA (Progressive Web App) - Journal Answers

**Student**: Md Jawar Safi (#2315024)  
**Course**: FGCT6021 Mobile Application Development  
**Lab 7**: Progressive Web App - Manifest, Service Worker, Caching & Offline Support  
**Date**: December 2025

---

## Journal Questions & Answers

### 1. Why is it useful to enhance your Flask app with PWA features?

Enhancing the Flask app with PWA features transforms the Learning Journal into a more reliable, accessible, and user-friendly application. PWA features enable **offline-first functionality**, allowing users to continue journaling even without internet connectivity. The **service worker** caches critical assets and data, reducing load times and server bandwidth. **Installability** via manifest.json allows users to install the app on desktop and mobile devices, providing an app-like experience without app store distribution. PWA features improve **user retention** by delivering instant loading, offline access, and home screen installation. Additionally, PWA standards ensure **cross-platform compatibility** and work seamlessly on any device with a modern browser, making the Learning Journal accessible to a broader audience while reducing deployment complexity compared to native mobile apps.

### 2. What did you use to support offline access and dynamic data?

**Service Worker**: Implemented a service worker (auto-generated by Vite PWA plugin) that intercepts network requests and caches static assets (CSS, JavaScript, images) and dynamic API responses. The service worker uses a **Cache-First strategy** for static assets (loading from cache when available) and **Network-First strategy** for API calls, falling back to cached data when offline.

**Cache Storage API**: Utilized the Cache Storage API through the service worker to persistently store:
- Static assets (HTML, CSS, JS, fonts)
- API responses from Flask backend (journal entries, projects)
- Previously loaded pages for offline viewing

**Fetch API**: Implemented dynamic data fetching through the Fetch API to:
- Request fresh data from the Flask backend when online
- Retrieve cached data from Cache Storage when offline
- Sync queued updates (POST, PUT, DELETE operations) when connectivity returns

**IndexedDB**: Combined with Cache Storage API to store structured data (journals, projects) locally, enabling complex offline queries and data manipulation without network requests.

**Service Worker Lifecycle**: Configured `install`, `activate`, and `fetch` event handlers to manage cache versioning, cleanup old caches, and intelligently decide when to serve cached content vs. fresh network data.

### 3. What extra feature did you add, and why?

**Online/Offline Status Indicator & Background Sync**: Added a **status indicator** that notifies users when they are offline, showing a visual badge in the header. When users go offline, the indicator turns red with "Offline" text; when online, it shows green with "Online".

**Why**: Users need to know whether new reflections will sync immediately or queue for later. When offline, users can continue adding reflections without confusion, knowing they'll sync automatically when connectivity returns. This creates **transparency** and **confidence** in offline functionality.

**Implementation**:
- Listened to `online` and `offline` window events
- Updated UI state based on navigator.onLine
- Queued POST/PUT/DELETE operations in localStorage when offline
- Background sync uses Service Worker to retry queued operations when online is detected
- Toast notifications inform users when sync completes successfully

**Result**: Users experience a seamless offline-to-online transition with no lost data and clear visibility into app status.

### 4. Did you face any challenges deploying your PWA, and how did you solve them?

**Challenge 1: HTTPS Requirement**
- **Problem**: Service workers only work over HTTPS (for security). PythonAnywhere and Replit both provide HTTPS, but local development in HTTP would fail.
- **Solution**: Verified deployment URLs use HTTPS. Configured `vite-plugin-pwa` to generate proper service worker. Tested PWA features on deployed sites rather than localhost HTTP.

**Challenge 2: Cache Invalidation**
- **Problem**: Browsers cache service workers aggressively. After deploying updates, users might get stale cached content.
- **Solution**: Implemented cache versioning in the service worker (`CacheStorage.open('v1')`, `v2`, etc.). On update, service worker clears old caches and pre-caches new assets. Used build tools to auto-increment version numbers.

**Challenge 3: Dynamic Data Caching**
- **Problem**: Caching API responses from Flask could serve stale reflections if new entries were created since the cache was populated.
- **Solution**: Implemented **Network-First strategy** for dynamic endpoints (e.g., `/api/reflections`). Always try to fetch fresh data from Flask first; if offline, fall back to cached response. Added timestamp-based cache validation to detect stale data.

**Challenge 4: Offline UX Confusion**
- **Problem**: Users didn't realize the app was offline, leading to confusion about whether their actions were saved.
- **Solution**: Added prominent online/offline status indicator and toast notifications. When users go offline, display message: "You're offline. Changes will sync when connection returns." When sync completes: "Synced X new reflections."

**Challenge 5: Service Worker Scope Issues**
- **Problem**: Service worker registered at wrong scope didn't intercept all requests.
- **Solution**: Ensured manifest.json and service worker registered at root scope (`/`). Verified folder structure: `/public/manifest.json` and service worker generated in `/dist/`.

---

## Implementation Summary

**Files Modified/Created**:
- `public/manifest.json` - App metadata for installability
- `vite.config.ts` - PWA plugin configuration
- Service worker (auto-generated by Vite PWA plugin)
- React components with online/offline status
- Flask backend updated to handle CORS for PWA requests

**PWA Features Deployed**:
✅ **Installability** - Users can install as app on desktop/mobile  
✅ **Offline Support** - All journaling features work without internet  
✅ **Background Sync** - Changes sync automatically when online  
✅ **Status Indicator** - Users see clear online/offline status  
✅ **Fast Loading** - Static assets cached for instant loading  
✅ **Home Screen Icon** - App icon appears on device home screen

**Deployment Verified**:
- Live at: https://learning-journal-x05x.onrender.com (React frontend)
- Flask backend: https://jawar9715.pythonanywhere.com
- Both accessible over HTTPS ✅
- Service worker registered and caching assets ✅
- Offline mode tested and working ✅

---

## Conclusion

Lab 7 demonstrates how Progressive Web App technologies transform a traditional web application into a reliable, installable, offline-capable platform. By combining manifest files, service workers, and intelligent caching strategies, the Learning Journal now provides a native app-like experience while remaining accessible through any modern web browser. The PWA implementation ensures users can capture their learning journey anytime, anywhere, with or without internet connectivity.
